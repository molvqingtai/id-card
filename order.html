<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, shrink-to-fit=no">
    <title>Order</title>
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/fontawesome.css">
    <link rel="stylesheet" href="css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/order.css">
  </head>
  <body class="min-vh-100 d-flex flex-column">
    <header class="container-fluid bg-dark px-sm-5 px-0 sticky-top">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="#">LOGO</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="container">
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav flex-fill justify-content-between text-nowrap">
              <li class="nav-item active">
                <a class="nav-link" href="./index.html">Home <span class="sr-only">(current)</span></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="./prices.html">Prices</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="./order.html">Order</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="./material.html">Material</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="./payments.html">Payments</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="./reseller.html">Reseller</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="./faq.html">FAQ</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="./about-us.html">About US</a>
              </li>
              <li class="nav-item d-flex justify-content-around d-lg-none">
                <a class="nav-link px-5" href="#">
                  <i class="fas fa-heart"></i>
                </a>
                <a class="nav-link px-5" href="#">
                  <i class="fas fa-shopping-bag"></i>
                </a>
              </li>
            </ul>
          </div>
        </div>
        <div class="d-lg-flex justify-content-end ml-3 text-nowrap d-none">
          <a href="#" class="text-light mr-4">
            <i class="fas fa-heart"></i>
          </a>
          <a href="#" class="text-light">
            <i class="fas fa-shopping-bag"></i>
          </a>
      </div>
      </nav>
    </header>

    <main class="flex-fill">
      <div class="container py-5 d-flex flex-column flex-lg-row">
        <form class="form novalidate">
          <div class="form-row">
            <div class="col-md-4 mb-3">
              <label for="state">State</label>
              <select class="form-control" id="state" name="state">
                <option value="测试商品-1">测试商品-1</option>
                <option value="测试商品-2">测试商品-2</option>
                <option value="测试商品-3">测试商品-3</option>
                <option value="测试商品-4">测试商品-4</option>
                <option value="测试商品-5">测试商品-5</option>
                <option value="测试商品-6">测试商品-6</option>
                <option value="测试商品-7">测试商品-7</option>
                <option value="测试商品-8">测试商品-8</option>
              </select>
            </div>
          </div>
          <div class="form-row">
            <div class="col-md-4 mb-3">
              <label class="text-justify" for="first-name" >First name</label>
              <input type="text" class="form-control" id="first-name" name="first-name" required>
            </div>
            <div class="col-md-4 mb-3">
              <label for="middle-name">Middle name</label>
              <input type="text" class="form-control" id="middle-name" name="middle-name" placeholder="This field is optional.">
            </div>
            <div class="col-md-4 mb-3">
              <label for="last-name">Last name</label>
              <input type="text" class="form-control" id="last-name" name="last-name" required>
            </div>
          </div>
          <div class="form-row">
            <div class="col-md-4 mb-3">
              <label for="date">Date of birth</label>
              <input type="text" class="form-control" id="date" name="date" required>
            </div>
            <div class="col-md-4 mb-3">
              <label for="feet">Height feet</label>
              <input type="text" class="form-control" id="feet" name="feet" required>
            </div>
            <div class="col-md-4 mb-3">
              <label for="inches">Height inches</label>
              <input type="text" class="form-control" id="inches" name="inches" required>
            </div>
          </div>
          <div class="form-row">
            <div class="col-md-3 mb-3">
              <label for="weight">Weight</label>
              <input type="text" class="form-control" id="weight" name="weight" required>
            </div>
            <div class="col-md-3 mb-3">
              <label for="eyes">Eyes</label>
              <select class="form-control" id="eyes" name="eyes">
                <option value="Black">Black</option>
                <option value="Brown">Brown</option>
                <option value="Blue">Blue</option>
                <option value="Gray">Gray</option>
                <option value="Green">Green</option>
                <option value="Hazel">Hazel</option>
                <option value="Maroon">Maroon</option>
                <option value="Pink">Pink</option>
                <option value="Multicolor">Multicolor</option>
              </select>
            </div>
            <div class="col-md-3 mb-3">
              <label for="hair">Hair</label>
              <select class="form-control" id="hair" name="hair">
                <option value="Bald">Bald</option>
                <option value="Black">Black</option>
                <option value="Blonde">Blonde</option>
                <option value="Brown">Brown</option>
                <option value="Gray">Gray</option>
                <option value="Red">Red</option>
                <option value="Sandy">Sandy</option>
                <option value="White">White</option>
              </select>
            </div>
            <div class="col-md-3 mb-3">
              <label for="gender">Gender</label>
              <select class="form-control" id="gender" name="gender">
                <option value="Male">Male</option>
                <option value="Female">Female</option>
              </select>
            </div>
          </div>
          <div class="form-row">
            <div class="col-md-6 mb-3">
              <label for="city">City</label>
              <input type="text" class="form-control" id="city" name="city" required>
            </div>
            <div class="col-md-6 mb-3">
              <label for="zip">Zip</label>
              <input type="zip" class="form-control" id="zip" name="zip" required>
            </div>
          </div>
          <div class="form-row">
            <div class="col">
              <label for="address">Address</label>
              <textarea class="form-control" id="address" name="address" placeholder="This is address you want on ID if you leave it blank we will make one up for you." required></textarea>
            </div>
          </div>
          <div class="form-row mt-3">
            <div class="col-md-6 mb-3">
              <label for="picture">Picture</label>
              <div class="custom-file">
                <input type="file" class="custom-file-input" id="picture" name="picture" accept="image/*" required>
                <label class="custom-file-label" for="picture">Choose image...</label>
              </div>
              <div class="form-view mt-2">
                <img class="form-view__image">
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <label for="picture">Signature</label>
              <div class="custom-file">
                <input type="file" class="custom-file-input" id="signature" name="signature" accept="image/*" required>
                <label class="custom-file-label" for="signature">Choose image...</label>
              </div>
              <div class="form-view mt-2">
                <img class="form-view__image">
              </div>
            </div>
          </div>
          <div class="form-row d-flex flex-nowrap flex-sm-wrap">
            <div class="col-md-6 d-flex justify-content-center">
              <button type="button" class="btn btn-success form-submit form-submit-add text-light">ADD and add another</button>
            </div>
            <div class="col-md-6 d-flex justify-content-center">
              <button type="button" class="btn btn-warning form-submit form-submit-out text-light">ADD and cheeckout</button>
            </div>
          </div>
        </form>
        <div class="total d-flex flex-fill flex-column align-items-center pt-5">
          <h3 class="total-title mb-3 text-nowrap">
            TOTAL: $<number class="total-title__price">0</number>
          </h3>
          <a href="./cart.html" class="total-link bg-danger text-white py-2 px-4 rounded-lg text-nowrap">
            <i class="fas fa-shopping-cart"></i> View cart (<number class="total-title__number">0</number>)
          </a>
        </div>
      </div>
    </main>

    <footer class="footer bg-dark py-3 text-white-50">
      <div class="container">
        <div class="share">
          <div class="share-item d-flex justify-content-sm-start justify-content-between">
            <a href="#" class="text-white-50 mr-sm-3">
              <i class="fab fa-snapchat"></i>
            </a>
            <a href="#" class="text-white-50 mr-sm-3">
              <i class="fab fa-facebook"></i>
            </a>
            <a href="#" class="text-white-50 mr-sm-3">
              <i class="fab fa-twitter"></i>
            </a>
            <a href="#" class="text-white-50 mr-sm-3">
              <i class="fab fa-youtube"></i>
            </a>
            <a href="#" class="text-white-50 mr-sm-3">
              <i class="fab fa-pinterest"></i>
            </a>
            <a href="#" class="text-white-50 mr-sm-3">
              <i class="fab fa-instagram"></i>
            </a>
            <a href="#" class="text-white-50 mr-sm-3">
              <i class="fab fa-tumblr"></i>
            </a>
          </div>
        </div>
        <div class="question d-flex flex-sm-row flex-column justify-content-between">
          <div class="question-item py-3">
            <h4 class="question-item__title">WHAT WE DO</h4>
            <p class="question-item__text">We offer high quality IDs at an affordable price. Every ID comes with a free duplicate and tracking number. All IDs are programmed to be scanned and to pass the backlight test. And....we do more then that! We offer you the chance to have a great time with your friends!</p>
          </div>
          <div class="question-item mx-sm-5 py-3">
            <h4 class="question-item__title">HOW WE DO IT</h4>
            <p class="question-item__text">Provide us with a digital photo of yourself up against any colour wall or backdrop. Wear dark clothing for contrast covering skin and keep your hair nice and neat.That is all you need to worry about! Let us do our job in order for you to taste some freedom!</p>
          </div>
          <div class="question-item py-3">
            <h4 class="question-item__title">HOW TO PAY</h4>
            <p class="question-item__text">We offer you secure and anonymous payment methods. Also, your information are safe with us! If you want an ID you can get it by paying via Western Union or BitCoin Litecoin . For special offers check our Products page.</p>
          </div>
        </div>
        <div class="copyright d-flex flex-sm-row flex-column justify-content-sm-between border-top border-light pt-3">
          <div class="copyright-item text-sm-left text-center"><a href="#" class="text-reset">WHOLESALE AT IDDSBUDDY</a></div>
          <div class="copyright-item text-center"><a href="#" class="text-reset">JOIN IDSBUDDY DISTRIBUTORS</a></div>
          <div class="copyright-item text-sm-right text-center"><a href="#" class="text-reset">© Copyright Fake IDs iddsbuddy</a><img src="https://icon.cnzz.com/img/pic.gif"></div>
        </div>
      </div>
    </footer>
    <div class="loading loading--hidden">
      <div class="spinner-border text-light" role="status">
        <span class="sr-only">Loading...</span>
      </div>
      <span class="text-light mt-3">Adding please wait.</span>
    </div>
  </body>
  <script src="js/jquery.slim.js" charset="utf-8"></script>
  <script src="js/popper.js" charset="utf-8"></script>
  <script src="js/bootstrap.js" charset="utf-8"></script>
  <script src="js/bootstrap-datepicker.js" charset="utf-8"></script>

  <script type="text/javascript">
    // 日历选择器
    $('#date').datepicker({})

    $('.toast').toast()
    // 图片预览
    $('.custom-file-input').on('change',({target}) => {
      const file = target.files[0]
      $(target).next().text(file.name)
      $(target).parent().next().children().attr('src',URL.createObjectURL(file))
    })


    // 更新合计
    const updateTotal = () =>{
      const cartList = JSON.parse(sessionStorage.getItem('cartList')||'[]')
      $('.total-title__price').text(cartList.reduce((acc, cur) => cur.price + acc,0))
      $('.total-title__number').text(cartList.length)
    }
    updateTotal()

    // 表单提交
    $('.form-submit').on('click',({target})=>{
      if($('.form')[0].checkValidity()){
        $('.form').removeClass('was-validated')

        // 获取表单数据
        const formData = $('.form').serializeArray().reduce((acc, cur) => {
          return {...acc,[cur.name]:cur.value  }
        }, {})

        // 获取商品列表
        const productList = JSON.parse(sessionStorage.getItem('productList')||'[]')

        // 获取购物车列表
        const cartList = JSON.parse(sessionStorage.getItem('cartList')||'[]')

        // 更新购物车列表
        const newCartList = [...cartList,formData].map((item,index,array)=>{
          const person = array.filter(jtem => jtem.state === item.state).length
          const price = productList.reduce((acc, cur) => cur.name === item.state?cur.group:acc,[]).reduce((acc, cur) => person >= cur.person ?cur.price:acc, 0)
          return {...item, price, id:index}
        })
        sessionStorage.setItem('cartList',JSON.stringify(newCartList))
        $('.loading').removeClass('loading--hidden')
        setTimeout(()=>$(target).hasClass('form-submit-add')?location.reload():location.href='cart.html',1000)
      }else {
        $('.form').addClass('was-validated')
      }
    })

  </script>
</html>
